<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Coffee Shop / cart</title>
<link rel='stylesheet' href='/css/woocommerce-layout.css' type='text/css' media='all'/>
<link rel='stylesheet' href='/css/woocommerce-smallscreen.css' type='text/css' media='only screen and (max-width: 768px)'/>
<link rel='stylesheet' href='/css/woocommerce.css' type='text/css' media='all'/>
<link rel='stylesheet' href='/css/font-awesome.min.css' type='text/css' media='all'/>
<link rel='stylesheet' href='/style.css' type='text/css' media='all'/>
<link rel='stylesheet' href='/https://fonts.googleapis.com/css?family=Oswald:400,500,700%7CRoboto:400,500,700%7CHerr+Von+Muellerhoff:400,500,700%7CQuattrocento+Sans:400,500,700' type='text/css' media='all'/>
<link rel='stylesheet' href='/css/easy-responsive-shortcodes.css' type='text/css' media='all'/>
</head>

<body class="archive post-type-archive post-type-archive-product woocommerce woocommerce-page">
	<div id="page">
		<div class="container">
			<header id="masthead" class="site-header">
			<div class="site-branding">
				<h1 class="site-title"><a href="index.html" rel="home">Coffee Shop</a></h1>
				<h2 class="site-description">Online coffeeshop made by some love</h2>
			</div>
			<nav id="site-navigation" class="main-navigation">
			<button class="menu-toggle">Menu</button>
			<a class="skip-link screen-reader-text" href="#content">Skip?</a>
			<div class="menu-menu-1-container">
				<ul id="menu-menu-1" class="menu">
					<li><a href="/">Home</a></li>
					<% if(!locals.status){ %>
					<li><a href="/auth/signin">Login</a></li>
					<li><a href="/auth/signup">Register</a></li>
					<% }else{ %>
					<li><a href="/cart">Shopping cart</a></li>
					<li><a href="/user/profile">My profile</a></li>
					<li><a href="/auth/logout">Logout</a></li>
					<% } %>
				</ul>
			</div>
			</nav>
			</header>


			<div id="content" class="site-content">
				<div id="primary" class="content-area column full">
					<main id="main" class="site-main" role="main">
					<ul class="products">


            <script>
              function remove(id) {
                var removeProduct = new XMLHttpRequest();
                removeProduct.open("DELETE", `/cart/${id}`, false);
                removeProduct.withCredentials = true;
                removeProduct.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                removeProduct.onreadystatechange = function () {
                  if (removeProduct.readyState == 4) {
                    if (removeProduct.status == 404) {
                      alert("Are you sure to delete the product ?");
                      location.reload(true);
                    }
                  }
                }
                removeProduct.send()
              }
            
              function update(id) {
                var updateQun = new XMLHttpRequest();
                updateQun.open("PUT", `/cart/${id}`, false);
                updateQun.withCredentials = true;
                updateQun.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                updateQun.onreadystatechange = function () {
                  if (updateQun.readyState == 4) {
                    if (updateQun.status == 404) {
                      alert("Are you sure to edit quantity the product ?"); 
                      location.reload(true);
                    }
                  }
                }
                updateQun.send(`totalQun=${document.getElementById("tot").value}`)
              }
            </script>



<table class="table table-striped">
  <tr>
    <th>Name</th>
    <th>Price</th>
    <th>Description</th>
  
  </tr>
  <tr>
  <% products.forEach(function(product){ %>
    <td><img class="card-img-top" alt="product image" src="<%=product.img%>" heigh="350" width="350" alt="" srcset=""></td>
    <td><%= product.name %></td>
    <td><%= product.price %> SAR</td>
    <td><%= product.description %></td>
    <td>
      <input type="number" id="tot" value="<%= product.totalQun %>" name="totalQun" step="1">
      <input type="submit" onclick="update('<%= product._id %>')" value="Edit Quantity">
       / 
      <input type="submit" onclick="remove('<%= product._id %>')" value="Delete Product">
    </td>
  </tr><br>
  <% }) %>
  
</table>


<h2><a href="/cart" class="clearfix btn">Checkout now</a></h2>
<br><br>

						</ul>



					</main>
					</div>
				</div>
			</div>
			<footer id="colophon" class="site-footer">
			<div class="container">
				<div class="site-info">
					<h1 style="font-family: 'Herr Von Muellerhoff';color: #ccc;font-weight:300;text-align: center;margin-bottom:0;margin-top:0;line-height:1.4;font-size: 46px;">Coffeshop</h1>
					by Mariam Alrashidi
		
				</div>
			</div>
			</footer>
			<a href="#top" class="smoothup" title="Back to top"><span class="genericon genericon-collapse"></span></a>
		</div>
		<!-- #page -->
		<script src='/js/jquery.js'></script>
		<script src='/js/plugins.js'></script>
		<script src='/js/scripts.js'></script>
		<script src='/js/masonry.pkgd.min.js'></script>
		</body>
		</html>





